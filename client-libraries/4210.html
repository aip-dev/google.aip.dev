<!DOCTYPE html>
<html lang="en-US" class="glue-flexbox">
  <head>
    <title>AIP-4210: Client library generators</title>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link href="//fonts.googleapis.com/css?family=Roboto:100,300,400,500,700|Google+Sans:400,500|Product+Sans:400&amp;lang=en" rel="stylesheet"></link>
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link rel="stylesheet" type="text/css" media="screen" href="//www.gstatic.com/glue/v22_1/glue.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=8d11fbcc">
    <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css?v=8d11fbcc">
    <script type="text/javascript" src="//code.jquery.com/jquery-3.4.0.min.js"></script>
    <script type="text/javascript" src="//www.gstatic.com/glue/latest/glue-detect.min.js"></script>
    <script type="text/javascript">
      $('html').css('visibility', 'hidden');
      $.when($.ready).then(() => {
        $('html').css('visibility', 'visible');
      });
    </script>
    <script type="text/javascript" src="/assets/js/global.js?v=8d11fbcc"></script>
    
<script type="text/javascript" src="/assets/js/syntax.js"></script>
<script type="text/javascript" src="/assets/js/graphviz/viz.js?v=8d11fbcc"></script>
<script type="text/javascript" src="/assets/js/graphviz/lite.render.js?v=8d11fbcc"></script>
<script type="text/javascript" src="/assets/js/aip/aip-graphviz.js?v=8d11fbcc"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140054909-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-140054909-1');
    </script>
  </head>
  <body>
    <!-- prettier-ignore -->
<header class="glue-header glue-header--single">
  <div class="glue-header__bar glue-header__bar--desktop glue-header__drawer">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                <use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>
                </svg>
              </div>
              <p class="glue-header__logo--product">AIPs</p>
            </a>
          </div>
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- LINK BAR-->
      <div class="glue-header__container glue-header__container--flex-auto">
        <nav class="glue-header__link-bar">
          <ul id="list-1" class="glue-header__list">
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/general" aria-level="1">Browse AIPs</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/news" aria-level="1">News</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/faq" aria-level="1">FAQ</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/contributing" aria-level="1">Contributing</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="https://linter.aip.dev/" target="_blank" aria-level="1">
                    API Linter
                    <svg role="img" class="glue-icon glue-icon--18px">
                      <use xlink:href="/assets/images/glue-icons.svg#open-in-new"></use>
                    </svg>
                  </a>
                </li>
              
            
          </ul>
        </nav>
      </div>
      <!-- CTA-->
      <div class="glue-header__container glue-header__container--cta">
        <div class="glue-header__cta">
        <div class="glue-sitesearch">
          <form method="GET" action="/search">
          <label for="q">Search this site</label>
          <input class="glue-sitesearch__input" type="text" name="q" id="q"
            placeholder="Search AIPs">
          <button type="submit" class="glue-button glue-sitesearch__submit" title="Submit">
            <svg role="img" class="glue-icon glue-icon--24px">
            <use xlink:href="/assets/images/glue-icons.svg#search"></use>
            </svg>
          </button>
          </form>
        </div>
        <a href="https://github.com/aip-dev/google.aip.dev" target="_blank" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Mobile header placeholder -->
  <div class="glue-header__bar glue-header__bar--mobile">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__hamburger glue-header__hamburger--first-tier">
            <div class="glue-header__hamburger-wrapper">
              <button type="button" class="glue-header__drawer-toggle-btn"
                aria-controls="drawer" aria-expanded="false" aria-label="Open the navigation drawer">
                <svg role="img" class="glue-icon glue-icon--24px"><use xlink:href="/assets/images/glue-icons.svg#menu"></use></svg>
              </button>
            </div>
          </div>
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                  <use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>
                </svg>
              </div>
              <p class="glue-header__logo--product">AIPs</p>
            </a>
          </div>
          <!-- SKIP -->
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- CTA -->
      <div class="glue-header__container">
        <div class="glue-header__cta">
        <a href="https://github.com/aip-dev/google.aip.dev" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <div class="glue-header__drawer-backdrop"></div>
</header>
    <div class="glue-page">
      
      <main role="main" id="page-content">
        
<nav id="aip-nav" class="docs-component-nav">
  <ul class="nav-list">
    <li class="nav-item nav-item-header">AIPs by Scope</li>
    <li class="nav-item">
      <a href="/general">General</a>
    </li>
    <li class="nav-item">
      <a href="/cloud">Google Cloud Platform</a>
    </li>
    <li class="nav-item">
      <a href="/auth">Auth</a>
    </li>
    <li class="nav-item">
      <a href="/client-libraries">Client libraries</a>
    </li>
    <li class="nav-item">
      <a href="/apps">Workspace</a>
    </li>
    <li class="nav-item">
      <a href="/aog">Actions on Google</a>
    </li>
    <li class="nav-item nav-item-header">AIPs</li>
    <li class="nav-item nav-item-active">
      <a href="/4210">
        <span class="aip-number">4210</span>
        Client library generators
      </a>
    </li>
    <li class="nav-item">
      <a href="/4221">
        <span class="aip-number">4221</span>
        Client-side retry
      </a>
    </li>
    <li class="nav-item">
      <a href="/4222">
        <span class="aip-number">4222</span>
        Routing headers
      </a>
    </li>
    <li class="nav-item">
      <a href="/4223">
        <span class="aip-number">4223</span>
        Client-side payload validation
      </a>
    </li>
    <li class="nav-item">
      <a href="/4231">
        <span class="aip-number">4231</span>
        Parsing resource names
      </a>
    </li>
    <li class="nav-item">
      <a href="/4232">
        <span class="aip-number">4232</span>
        Method signatures
      </a>
    </li>
    <li class="nav-item">
      <a href="/4233">
        <span class="aip-number">4233</span>
        Automatic pagination
      </a>
    </li>
    <li class="nav-item">
      <a href="/4234">
        <span class="aip-number">4234</span>
        Common service client mixins
      </a>
    </li>
    <li class="nav-item">
      <a href="/4235">
        <span class="aip-number">4235</span>
        Automatically populate fields in the request message
      </a>
    </li>
    <li class="nav-item">
      <a href="/4236">
        <span class="aip-number">4236</span>
        Version-aware clients
      </a>
    </li>
    <li class="nav-item">
      <a href="/4290">
        <span class="aip-number">4290</span>
        Docker interface
      </a>
    </li>
    </ul>
</nav>
<section id="jump-content">
          
<aside id="aip-sidebar" class="docs-component-sidebar">
  <table id="aip-summary">
    <tr><th colspan="2">Client library generators</th></tr>
    <tr><td>Number</td><td>4210</td></tr>
    <tr><td>Permalink</td><td><a href="https://google.aip.dev/client-libraries/4210">google.aip.dev/client-libraries/4210</a></td></tr>
    <tr><td>Scope</td><td>Client libraries</td></tr>
    <tr><td>State</td><td>Approved</td></tr>
    <tr><td>Created</td><td>2018-06-22</td></tr>
    <tr><td>Updated</td><td>2018-06-22</td></tr>
  </table>

  <section id="aip-toc" class="docs-component-sidebar-toc">
    <div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#guidance">Guidance</a><ul>
<li><a href="#protobuf-plugins">Protobuf plugins</a></li>
<li><a href="#cli-options">CLI options</a></li>
</ul>
</li>
<li><a href="#expected-behavior">Expected behavior</a><ul>
<li><a href="#messages-and-enums">Messages and Enums</a></li>
<li><a href="#services-and-methods">Services and methods</a></li>
<li><a href="#long-running-operations">Long-running operations</a></li>
<li><a href="#streaming">Streaming</a></li>
</ul>
</li>
<li><a href="#changelog">Changelog</a></li>
</ul>
</div>

  </section>

  <section class="docs-component-sidebar-actions">
    <ul>
      <li><a href="https://github.com/aip-dev/google.aip.dev/issues/">File Bug</a></li>
      <li><a href="https://github.com/aip-dev/google.aip.dev/blob/master/aip/client-libraries/4210.md">View source</a></li>
      <li><a href="https://github.com/aip-dev/google.aip.dev/edit/master/aip/client-libraries/4210.md">Edit this page</a></li>
    </ul>
  </section>
</aside>
<section id="aip-main" class="docs-component-main">
  <section class="section-breadcrumbs">
  <nav
    class="glue-breadcrumbs glue-mod-mt-std glue-mod-mb-std"
    aria-label="You are here."
  >
    <ol class="glue-breadcrumbs__list aip-breadcrumbs">
      <li class="glue-breadcrumbs__item" aria-level="1">
        <a class="glue-breadcrumbs__link" href="/">
          API Improvement Proposals
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item" aria-level="2">
        <a class="glue-breadcrumbs__link" href="/client-libraries">
          Client libraries AIPs
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item glue-breadcrumbs__item--active"
          aria-level="3">
        Client library generators
      </li>
    </ol>
  </nav>
</section>
  
  <h4 class="aip-number">AIP-4210</h4>
  <h1 id="client-library-generators">Client library generators</h1>
<p>API guidelines exist in order to promote simple, intuitive, and consistent
APIs. Users familiar with APIs that generally adhere to AIP guidance are able
to take what they learn in prior APIs and apply it to new ones.</p>
<p>Client libraries provide a mechanism for users to get started with APIs more
quickly, by simplifying common concerns (such as auth) and by a language-native
way to call API endpoints and receive language-native responses. However, for
these libraries to provide the most value, they also must be simple, intuitive,
and consistent. Code generators provide a means for producing consistent client
libraries at scale.</p>
<p>Code generators following the standards in these AIPs are known as "generated
API client generators", or <em>GAPIC generators</em> for short. The resulting
libraries are colloquially called <em>GAPICs</em>.</p>
<p><strong>Note:</strong> Because this AIP describes guidance and requirements in a
language-neutral way, it uses generic terminology which may be imprecise or
inappropriate in certain languages or environments (for example, the use of the
term <code>class</code> even though languages such as Go do not have classes). This AIP's
particular use of vocabulary is best understood as an explanation of
principles, and precise adherence to exact vocabulary in this AIP is not an
expectation.</p>
<h2 id="guidance">Guidance</h2>
<p>The general flow of code generation for client libraries and supporting code in
most supported languages is outlined below.</p>
<p><strong>Note:</strong> Exceptions to this pattern are typically due to use of a unique stack
e.g. Node.js use of <code>protobuf.js</code> and <code>grpc-node</code> which don't have code
generation, or Python using a protobuf wrapper in <code>proto-plus-python</code>, but the
general GAPIC flow remains the same.</p>
<div class="highlight language-graphviz"><pre><span></span><code><span class="k">digraph</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">node</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">style</span><span class="p">=</span><span class="s2">&quot;filled,solid&quot;</span><span class="w"> </span><span class="na">shape</span><span class="p">=</span><span class="s">box</span><span class="w"> </span><span class="na">fontname</span><span class="p">=</span><span class="s2">&quot;Roboto&quot;</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="na">splines</span><span class="p">=</span><span class="s">ortho</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="na">nodesep</span><span class="p">=</span><span class="m">0.3</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="na">center</span><span class="p">=</span><span class="s">true</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="nt">proto</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;API Protobuf\nDescriptors&quot;</span><span class="w"> </span><span class="na">shape</span><span class="p">=</span><span class="s">rectangle</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">aliceblue</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="w">  </span><span class="k">subgraph</span><span class="w"> </span><span class="nt">cluster_code_generators</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">rank</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">same</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="na">style</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">filled</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="na">fillcolor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">lightgrey</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">node</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">shape</span><span class="p">=</span><span class="s">oval</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="nt">protobuf</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;protobuf\ngenerator&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">deepskyblue3</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="nt">grpc</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;gRPC\ngenerator&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">gold3</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="nt">gapic</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;GAPIC\ngenerator&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">darkseagreen</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nt">proto</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">protobuf</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nt">proto</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">grpc</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nt">proto</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">gapic</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">subgraph</span><span class="w"> </span><span class="nt">cluster_generated_code</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">rank</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">same</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="na">style</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">filled</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="na">fillcolor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">lightgrey</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">node</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">shape</span><span class="p">=</span><span class="s">rectangle</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="nt">protobuf_output</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;Message &amp; Enum\nCode&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">deepskyblue3</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="nt">grpc_output</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;Server &amp; Client\nStubs&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">gold3</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="nt">gapic_output</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;Google API\nClient&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">darkseagreen</span><span class="w"> </span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nt">protobuf</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">protobuf_output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nt">grpc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">grpc_output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nt">gapic</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">gapic_output</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="nt">assembly</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;Package\nassembly&quot;</span><span class="w"> </span><span class="na">shape</span><span class="p">=</span><span class="s">oval</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">aliceblue</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="w">  </span><span class="nt">protobuf_output</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">assembly</span><span class="w"></span>
<span class="w">  </span><span class="nt">grpc_output</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">assembly</span><span class="w"></span>
<span class="w">  </span><span class="nt">gapic_output</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">assembly</span><span class="w"></span>

<span class="w">  </span><span class="nt">assembled_package</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="na">label</span><span class="p">=</span><span class="s2">&quot;Package of\ngenerated code&quot;</span><span class="w"> </span><span class="na">fillcolor</span><span class="p">=</span><span class="s">aliceblue</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="w">  </span><span class="nt">assembly</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nt">assembled_package</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The following sections focus on the "GAPIC generator" in the above diagram.</p>
<h3 id="protobuf-plugins">Protobuf plugins</h3>
<p>The protobuf compiler, <code>protoc</code>, supports a <a href="https://protobuf.dev/reference/other">plugin system</a> for code
generation. The plugin system allows plugins to be written <em>in</em> and <em>for</em> any
language.</p>
<p>Code generators <strong>must</strong> be implemented as <code>protoc</code> plugins. The following
rules apply to the implementation of a client library generator as a <code>protoc</code>
plugin:</p>
<ul>
<li>The plugin  <strong>should</strong> be written in the language being targeted for
  generation.</li>
<li><code>protoc</code> expects plugins to be an executable in <code>$PATH</code>, and named
  <code>protoc-gen-{plugin_name}</code>, corresponding to the <code>--{plugin_name}_out</code> option
  sent to the <code>protoc</code> executable. As such:<ul>
<li>the plugin executable <strong>should</strong> be named <code>protoc-gen-{lang}_gapic</code></li>
<li>the plugin option  <strong>should</strong> follow the convention <code>--{lang}_gapic_out</code></li>
</ul>
</li>
<li>The plugin <strong>must not</strong> leverage <code>protoc</code> "insertion points". Despite the
  <code>protoc</code> plugin documentation indicating the existence of insertion points,
  their use is unsupported and discouraged by the Protobuf team.</li>
</ul>
<h3 id="cli-options">CLI options</h3>
<p>Code generators <strong>should</strong> be able to run without any options or flags if at
all possible, and be able to generate a valid library from only the protos. If
options are required, <code>protoc</code> allows them to be passed as
<code>--{plugin_name}_opt</code>, and the string provided here becomes set as the
<code>parameter</code> string on the <code>CodeGeneratorRequest</code>.</p>
<p><strong>Important:</strong> The <code>CodeGeneratorRequest.parameter</code> value is a comma-delimited
string of <em>all</em> associated plugin option values that appear at execution time.
This means that commas cannot be used to delimit list-like plugin option values.</p>
<p>Code generators <strong>must not</strong> rely on environment variables for configuration.</p>
<h2 id="expected-behavior">Expected behavior</h2>
<p>This section outlines the expected behavioral attributes of the <em>output of</em> the
client library generator (in other words: the libraries that the generators
write). Client libraries <strong>must</strong> implement these concepts in order to be
considered complete.</p>
<h3 id="messages-and-enums">Messages and Enums</h3>
<p>Client library generators <strong>should not</strong> generate code for <code>message</code> or <code>enum</code>
descriptors which are already generated by the Protobuf-provided code
generators.</p>
<h3 id="services-and-methods">Services and methods</h3>
<p>Each of the <code>service</code> and <code>rpc</code> directives in the requested protos <strong>must</strong> be
represented in the client library output, unless the language or transport is
unable to support it.</p>
<p><strong>Note:</strong> While how to accomplish this may vary from language to language, in
most classical languages it is probably a class for each service, containing
methods for each RPC.</p>
<ul>
<li>The classes generated for each <code>service</code> directive <strong>must</strong> honor the
  <code>google.api.default_host</code> annotation if it is provided, and use that host as
  the default hostname. These classes <strong>should</strong> provide a mechanism for the
  end user to override the hostname.<ul>
<li>If the <code>google.api.default_host</code> annotation is not present on the <code>service</code>
  directive, then the generated class <strong>should</strong> require a hostname when it
  is instantiated.</li>
</ul>
</li>
<li>Additionally, if the classes generated for each service support using OAuth
  and service credentials, they <strong>must</strong> honor the <code>google.api.oauth_scopes</code>
  annotation (if it is provided), and use these scopes by default.</li>
<li>Services that have set the <code>deprecated</code> protobuf option to <code>true</code> <strong>should</strong> have an
  equivalent deprecation tag generated in the generated class. If applicable, this
  tag may include a comment that specifies when the service will be removed, which
  is typically the next major version update. Similarly, RPCs with this option set
  to <code>true</code> <strong>should</strong> have their generated language method(s) marked as deprecated.</li>
<li>Finally, service classes <strong>must</strong> also accept credentials, which are used
  appropriately when requests are made. (Accepting a custom gRPC channel
  satisfies this requirement.)</li>
<li>Code generators <strong>must not</strong> generate client <em>stub</em> classes, that would
  normally be generated by gRPC, in addition to client library classes.</li>
</ul>
<h3 id="long-running-operations">Long-running operations</h3>
<!-- TODO(1145): Move to its own client library AIP. -->

<p>An RPC is considered to be a "long-running" RPC if (and only if) the RPC's
return type is <a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L122"><code>google.longrunning.Operation</code></a>. Any API which has one or
more RPCs returning an <code>Operation</code> is expected to implement the <code>Operations</code>
service.</p>
<p>Because the <code>response</code> and <code>metadata</code> fields in <a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L122"><code>Operation</code></a> are of the
type <a href="https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/any.proto"><code>google.protobuf.Any</code></a>, it is necessary to know what message to use to
deserialize them. This is annotated on the RPC using the
<a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L222"><code>google.longrunning.operation_info</code></a> annotation.</p>
<p><strong>Note:</strong> The values in this struct are <em>strings</em>, not message objects; the
code generator uses the string to determine the appropriate message to use.
Strings with no period (<code>.</code>) character refer to a message in the same proto
package.</p>
<p>Code generators <strong>should</strong> fail with an error if a type is provided in the
<a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L222"><code>operation_info</code></a> annotation which was not imported, or if no response type
or metadata type is provided. Code generators <strong>should</strong> fail with an error if
<em>either</em> the <code>response_type</code> or <code>metadata_type</code> keys are omitted.</p>
<p>Client libraries <strong>must</strong> honor the LRO interface; if an RPC has an
<a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L122"><code>Operation</code></a> as its return type, the generated method <strong>must</strong> intercept it
and return an appropriate idiomatic object for resolving the LRO (such as a
<code>Future</code> or <code>Promise</code> bound to the underlying <a href="https://github.com/googleapis/googleapis/blob/master/google/longrunning/operations.proto#L122"><code>Operation</code></a> object).</p>
<h3 id="streaming">Streaming</h3>
<p>Client libraries <strong>must</strong> implement streaming to the extent that their
supporting transports allow. An RPC is considered to be streaming if the
<code>stream</code> keyword is present on the argument or response type. This is present
in the <a href="https://github.com/protocolbuffers/protobuf/blob/master/src/google/protobuf/descriptor.proto#L269"><code>MethodDescriptorProto</code></a> message using the <code>client_streaming</code> and
<code>server_streaming</code> keys.</p>
<!-- prettier-ignore-start -->
<!-- prettier-ignore-end -->

<h2 id="changelog">Changelog</h2>
<ul>
<li><strong>2023-06-22</strong>: Added code gen diagram, message/enum guidance, and cleaned up
  plugin &amp; option guidance.</li>
</ul>
  <footer>
  Except as otherwise noted, the content of this page is licensed under the
  <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
  Attribution 4.0 License</a>, and code samples are licensed under the
  <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
  <span class="no-print">For details, see <a href="/licensing">content
  licensing</a>.</span>
</footer>
</section>

        </section>
      </main>
      
    </div>
    <script src="//www.gstatic.com/external_hosted/hammerjs/v2_0_2/hammer.min.js"></script>
    <script src="//www.gstatic.com/glue/v22_1/glue-vanilla.min.js"></script>
    <script type="text/javascript">
      const headerElement = document.querySelector('.glue-header');
      if (headerElement) {
        new window.glue.ui.header.Header(headerElement);
      }
    </script>
  </body>
</html>