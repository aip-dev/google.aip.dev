---
aip:
  id: 3021
  state: draft
  created: 2019-10-04
  updated: 2019-10-04
  type: guidance
  scope: aog
js:
  - /assets/js/graphviz/viz.js
  - /assets/js/graphviz/lite.render.js
  - /assets/js/aip/aip-graphviz.js
permalink: /3021
---

# Type protos in Actions on Google APIs

Many Actions on Google fulfillment APIs need to represent typed data (datetime,
money, etc.). In some cases, there are common components for representing these
types.

## Guidance

Fulfillment APIs **must** use the AoG common types when applicable, and **must
not** use alternative type protos. For example, an API which needs to represent
a monetary amount **must** use [google.type.Money][money], and **must not** use
an alternative representation.

APIs **may** wrap existing types in new protos. This may be useful in order to
define compound types, provide additional metadata, provide semantic signals
(if the typed value was obtained from a user query), etc.

## Actions on Google common types

The AoG common types include all the protobuf types and API types defined in
[AIP-213][], as well as all the protos in
[google.actions.type.\*][actions-type].

### Adding new types

If a given API needs a type for which there is no existing common type, and the
type is not conceptually specific to that API, and the type is well understood
enough to be modeled in a permanent/unversioned way, then API author **should**
consider proposing a new AoG common type in
[google.actions.type.\*][actions-type].

The guidance in the appendix of [AIP-213][] also applies to creating new AoG
common types. Specifically, API authors proposing new types **should** consider
whether a new type should be a Google-wide common type rather than an AoG
common type. One exception to this is that new AoG common types are not
proposed by opening a GitHub ticket. Instead, AoG API authors should see
//google/actions/type/OWNERS for contact information.

## Built-In Intent arguments and common types

AoG Built-In Intents (BIIs) are not a fulfillment API, and their arguments use
JSON-LD representations of Schema.org entities, not AoG common types. APIs
which use common types and wish to support BII arguments generically **should**
do so by mapping BII arguments (or properties thereof) to common types.

Only certain Schema.org entity types will make sense to map to a given type. In
order to support BII arguments with types that cannot be mapped to a common
type, APIs **may** support configuration via BII argument paths, allowing users
to specify a property of a Schema.org entity which _can_ be mapped to a common
type.

### BII argument paths

APIs which support BII argument paths **should** use the syntax defined in this
section.

BII argument paths are dot-delimited strings that identify a specific
Schema.org entity within the list of arguments to the BII.

For example, take the following hypothetical BII arguments `grant` and `date`:

```json
{
  "grant": {
    "@context": "http://schema.org",
    "@type": "MonetaryGrant",
    "funder": {
      "@type": "Organization",
      "name": "Google"
    },
    "amount": {
      "@type": "MonetaryAmount",
      "currency": "USD",
      "value": 100
    }
  },
  "date": "2000-01-01"
}
```

There is no common type to which MonetaryGrant can be mapped, but the `grant`
argument contains an `amount` property of type [MonetaryAmount][], which _can_
be mapped to [Money][]. This property can be referenced with the path string
`"grant.amount"`.

#### Properties with multiple values

Because all Schema.org properties may have multiple values, values other than
the first may be referenced by indexing with square brackets. For example, take
this hypothetical BII argument:

```json
{
  "menuItem": {
    "@context": "http://schema.org",
    "@type": "MenuItem",
    "name": "Pizza",
    "menuAddOn": {
      "@type": "MenuItem",
      "name": "pineapple"
    },
    "menuAddOn": {
      "@type": "MenuItem",
      "name": "extra cheese"
    }
  },
  "date": "2000-01-01"
}
```

In this example, the path `"menuItem.menuAddOn[1].name"` would evaluate to
`"extra cheese"`.

When there are no square brackets, the first value is assumed; using `[0]` is a
no-op. That is, `"menuItem.menuAddOn.name"` and `"menuItem.menuAddOn[0].name"`
are equivalent, and would _both_ evaluate to `"pineapple"`.

### BII argument to common type mappings

APIs which support BII argument mapping **should** support these type mappings
from Schema.org entity type to AoG common types:

| Common type       | Schema.org entity types                          |
| ----------------- | ------------------------------------------------ |
| [Date][]          | [Date][schema-date]                              |
| [DateTime][]      | [DateTime][schema-datetime]                      |
| [TimeOfDay][]     | [Time][]                                         |
| [Duration][]      | [Duration][schema-duration]                      |
| [Money][]         | [MonetaryAmount][]                               |
| [PostalAddress][] | [Place][], [PostalAddress][schema-postaladdress] |

### BII argument to string mappings

Some AoG APIs, such as [App Actions][], are URL-based, and thus can only map
BII arguments to strings (URL parameters). APIs which can only map BII
arguments to strings **should** support mapping at least the following
Schema.org entity types:

- [Text][]
- [Number][]
- [Boolean][]
- [Date][schema-date]
- [DateTime][schema-datetime]
- [Time][]

<!-- prettier-ignore-start -->
[aip-213]: ../0213.md
[date]: https://github.com/googleapis/api-common-protos/tree/master/google/type/date.proto
[datetime]: https://github.com/googleapis/api-common-protos/tree/master/google/type/datetime.proto
[timeofday]: https://github.com/googleapis/api-common-protos/tree/master/google/type/timeofday.proto
[duration]: https://github.com/protocolbuffers/protobuf/tree/master/src/google/protobuf/duration.proto
[money]: https://github.com/googleapis/api-common-protos/tree/master/google/type/money.proto
[postaladdress]: https://github.com/googleapis/api-common-protos/tree/master/google/type/postal_address.proto
[type]: https://github.com/googleapis/api-common-protos/tree/master/google/type/
[actions-type]: https://github.com/googleapis/api-common-protos/tree/master/google/actions/type/
[app actions]: https://developers.google.com/actions/appactions/overview
[schema-date]: https://schema.org/Date
[schema-datetime]: https://schema.org/DateTime
[time]: https://schema.org/Time
[schema-duration]: http://schema.org/Duration
[monetaryamount]: https://schema.org/MonetaryAmount
[place]: https://schema.org/Place
[schema-postaladdress]: https://schema.org/PostalAddress
[text]: https://schema.org/Text
[number]: https://schema.org/Number
[boolean]: https://schema.org/Boolean
<!-- prettier-ignore-end -->
