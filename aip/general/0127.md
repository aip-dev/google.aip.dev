---from googleapiclient.discovery import build
from google.oauth2.service_account import Credentials

def create_google_presentation():
    SCOPES = ['https://www.googleapis.com/auth/presentations']
    import os
SERVICE_ACCOUNT_FILE = os.getenv('SERVICE_ACCOUNT_FILE', 'path/to/your/service-account-key.json')

    creds = Credentials.from_service_account_file(SERVICE_ACCOUNT_FILE, scopes=SCOPES)
    service = build('slides', 'v1', credentials=creds)

    # Create a new presentation
    presentation = service.presentations().create(body={"title": "Lürssen Werft Präsentation"}).execute()
    presentation_id = presentation.get('presentationId', None)
    if not presentation_id:
        raise ValueError("Failed to retrieve the presentation ID.")

    # Slide 1: Title Slide
    requests = [
        {
            'createSlide': {
                'slideLayoutReference': {
                    'predefinedLayout': 'TITLE'
                }
            }
        },
        {
            'insertText': {
                'objectId': 'generated_title_0',
                'text': "Lürssen Werft"
            }
        },
        {
            'insertText': {
                'objectId': 'generated_subtitle_0',
                'text': "Ein Unternehmen aus Bremen mit internationalen Verflechtungen"
            }
        }
    ]

    # Slide 2: Kerninformationen
    requests.extend([
        {
            'createSlide': {
                'slideLayoutReference': {
                    'predefinedLayout': 'TITLE_AND_BODY'
                }
            }
        },
        {
            'insertText': {
                'objectId': 'title_1',
                'text': "Kerninformationen"
            }
        },
        {
            'insertText': {
                'objectId': 'body_1',
                'text': (
                    "\u2022 Produkte/Dienstleistungen: Bau von Luxusyachten, Marineschiffen und Spezialschiffen.\n"
                    "\u2022 Branche: Schiffbau und maritime Industrie.\n\n"
                    "\u2022 Internationale Handelsbeziehungen: Export von Luxusyachten weltweit, Import von High-Tech-Komponenten.\n"
                    "\u2022 Auslandsverflechtungen: Standorte und Partner weltweit, Fokus auf globale Märkte und Lieferketten."
                )
            }
        }
    ])

    # Execute the batchUpdate
    body = {'requests': requests}
    try:
        service.presentations().batchUpdate(presentationId=presentation_id, body=body).execute()
    except Exception as e:
        raise RuntimeError(f"Failed to update presentation: {e}")

    print(f'Präsentation erstellt: https://docs.google.com/presentation/d/{presentation_id}/')

create_google_presentation()
post


using the `google.api.http` annotation:


