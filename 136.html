<!DOCTYPE html>
<html lang="en-US" class="glue-flexbox">
  <head>
    <title>AIP-136: Custom methods</title>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link href="//fonts.googleapis.com/css?family=Roboto:100,300,400,500,700|Google+Sans:400,500|Product+Sans:400&amp;lang=en" rel="stylesheet"></link>
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link rel="stylesheet" type="text/css" media="screen" href="//www.gstatic.com/glue/v22_1/glue.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=631cebbe">
    <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css?v=631cebbe">
    <script type="text/javascript" src="//code.jquery.com/jquery-3.4.0.min.js"></script>
    <script type="text/javascript" src="//www.gstatic.com/glue/latest/glue-detect.min.js"></script>
    <script type="text/javascript">
      $('html').css('visibility', 'hidden');
      $.when($.ready).then(() => {
        $('html').css('visibility', 'visible');
      });
    </script>
    <script type="text/javascript" src="/assets/js/global.js?v=631cebbe"></script>
    
<script type="text/javascript" src="/assets/js/syntax.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140054909-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-140054909-1');
    </script>
  </head>
  <body>
    <!-- prettier-ignore -->
<header class="glue-header glue-header--single">
  <div class="glue-header__bar glue-header__bar--desktop glue-header__drawer">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                <use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>
                </svg>
              </div>
              <p class="glue-header__logo--product">AIPs</p>
            </a>
          </div>
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- LINK BAR-->
      <div class="glue-header__container glue-header__container--flex-auto">
        <nav class="glue-header__link-bar">
          <ul id="list-1" class="glue-header__list">
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/general" aria-level="1">Browse AIPs</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/news" aria-level="1">News</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/faq" aria-level="1">FAQ</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/contributing" aria-level="1">Contributing</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="https://linter.aip.dev/" target="_blank" aria-level="1">
                    API Linter
                    <svg role="img" class="glue-icon glue-icon--18px">
                      <use xlink:href="/assets/images/glue-icons.svg#open-in-new"></use>
                    </svg>
                  </a>
                </li>
              
            
          </ul>
        </nav>
      </div>
      <!-- CTA-->
      <div class="glue-header__container glue-header__container--cta">
        <div class="glue-header__cta">
        <div class="glue-sitesearch">
          <form method="GET" action="/search">
          <label for="q">Search this site</label>
          <input class="glue-sitesearch__input" type="text" name="q" id="q"
            placeholder="Search AIPs">
          <button type="submit" class="glue-button glue-sitesearch__submit" title="Submit">
            <svg role="img" class="glue-icon glue-icon--24px">
            <use xlink:href="/assets/images/glue-icons.svg#search"></use>
            </svg>
          </button>
          </form>
        </div>
        <a href="https://github.com/aip-dev/google.aip.dev" target="_blank" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Mobile header placeholder -->
  <div class="glue-header__bar glue-header__bar--mobile">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__hamburger glue-header__hamburger--first-tier">
            <div class="glue-header__hamburger-wrapper">
              <button type="button" class="glue-header__drawer-toggle-btn"
                aria-controls="drawer" aria-expanded="false" aria-label="Open the navigation drawer">
                <svg role="img" class="glue-icon glue-icon--24px"><use xlink:href="/assets/images/glue-icons.svg#menu"></use></svg>
              </button>
            </div>
          </div>
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                  <use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>
                </svg>
              </div>
              <p class="glue-header__logo--product">AIPs</p>
            </a>
          </div>
          <!-- SKIP -->
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- CTA -->
      <div class="glue-header__container">
        <div class="glue-header__cta">
        <a href="https://github.com/aip-dev/google.aip.dev" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <div class="glue-header__drawer-backdrop"></div>
</header>
    <div class="glue-page">
      
      <main role="main" id="page-content">
        
<nav id="aip-nav" class="docs-component-nav">
  <ul class="nav-list">
    <li class="nav-item nav-item-header">AIPs by Scope</li>
    <li class="nav-item">
      <a href="/general">General</a>
    </li>
    <li class="nav-item">
      <a href="/cloud">Google Cloud Platform</a>
    </li>
    <li class="nav-item">
      <a href="/auth">Auth</a>
    </li>
    <li class="nav-item">
      <a href="/client-libraries">Client libraries</a>
    </li>
    <li class="nav-item">
      <a href="/apps">Workspace</a>
    </li>
    <li class="nav-item">
      <a href="/aog">Actions on Google</a>
    </li>
    <li class="nav-item nav-item-header">AIPs</li>
    <li class="nav-item">
      <a href="/1">
        <span class="aip-number">1</span>
        AIP Purpose and Guidelines
      </a>
    </li>
    <li class="nav-item">
      <a href="/2">
        <span class="aip-number">2</span>
        AIP Numbering
      </a>
    </li>
    <li class="nav-item">
      <a href="/3">
        <span class="aip-number">3</span>
        AIP Versioning
      </a>
    </li>
    <li class="nav-item">
      <a href="/8">
        <span class="aip-number">8</span>
        AIP Style and Guidance
      </a>
    </li>
    <li class="nav-item">
      <a href="/9">
        <span class="aip-number">9</span>
        Glossary
      </a>
    </li>
    <li class="nav-item">
      <a href="/100">
        <span class="aip-number">100</span>
        API Design Review FAQ
      </a>
    </li>
    <li class="nav-item">
      <a href="/111">
        <span class="aip-number">111</span>
        Planes
      </a>
    </li>
    <li class="nav-item">
      <a href="/121">
        <span class="aip-number">121</span>
        Resource-oriented design
      </a>
    </li>
    <li class="nav-item">
      <a href="/122">
        <span class="aip-number">122</span>
        Resource names
      </a>
    </li>
    <li class="nav-item">
      <a href="/123">
        <span class="aip-number">123</span>
        Resource types
      </a>
    </li>
    <li class="nav-item">
      <a href="/124">
        <span class="aip-number">124</span>
        Resource association
      </a>
    </li>
    <li class="nav-item">
      <a href="/126">
        <span class="aip-number">126</span>
        Enumerations
      </a>
    </li>
    <li class="nav-item">
      <a href="/127">
        <span class="aip-number">127</span>
        HTTP and gRPC Transcoding
      </a>
    </li>
    <li class="nav-item">
      <a href="/128">
        <span class="aip-number">128</span>
        Declarative-friendly interfaces
      </a>
    </li>
    <li class="nav-item">
      <a href="/129">
        <span class="aip-number">129</span>
        Server-Modified Values and Defaults
      </a>
    </li>
    <li class="nav-item">
      <a href="/130">
        <span class="aip-number">130</span>
        Methods
      </a>
    </li>
    <li class="nav-item">
      <a href="/131">
        <span class="aip-number">131</span>
        Standard methods: Get
      </a>
    </li>
    <li class="nav-item">
      <a href="/132">
        <span class="aip-number">132</span>
        Standard methods: List
      </a>
    </li>
    <li class="nav-item">
      <a href="/133">
        <span class="aip-number">133</span>
        Standard methods: Create
      </a>
    </li>
    <li class="nav-item">
      <a href="/134">
        <span class="aip-number">134</span>
        Standard methods: Update
      </a>
    </li>
    <li class="nav-item">
      <a href="/135">
        <span class="aip-number">135</span>
        Standard methods: Delete
      </a>
    </li>
    <li class="nav-item nav-item-active">
      <a href="/136">
        <span class="aip-number">136</span>
        Custom methods
      </a>
    </li>
    <li class="nav-item">
      <a href="/140">
        <span class="aip-number">140</span>
        Field names
      </a>
    </li>
    <li class="nav-item">
      <a href="/141">
        <span class="aip-number">141</span>
        Quantities
      </a>
    </li>
    <li class="nav-item">
      <a href="/142">
        <span class="aip-number">142</span>
        Time and duration
      </a>
    </li>
    <li class="nav-item">
      <a href="/143">
        <span class="aip-number">143</span>
        Standardized codes
      </a>
    </li>
    <li class="nav-item">
      <a href="/144">
        <span class="aip-number">144</span>
        Repeated fields
      </a>
    </li>
    <li class="nav-item">
      <a href="/145">
        <span class="aip-number">145</span>
        Ranges
      </a>
    </li>
    <li class="nav-item">
      <a href="/146">
        <span class="aip-number">146</span>
        Generic fields
      </a>
    </li>
    <li class="nav-item">
      <a href="/147">
        <span class="aip-number">147</span>
        Sensitive fields
      </a>
    </li>
    <li class="nav-item">
      <a href="/148">
        <span class="aip-number">148</span>
        Standard fields
      </a>
    </li>
    <li class="nav-item">
      <a href="/149">
        <span class="aip-number">149</span>
        Unset field values
      </a>
    </li>
    <li class="nav-item">
      <a href="/151">
        <span class="aip-number">151</span>
        Long-running operations
      </a>
    </li>
    <li class="nav-item">
      <a href="/152">
        <span class="aip-number">152</span>
        Jobs
      </a>
    </li>
    <li class="nav-item">
      <a href="/153">
        <span class="aip-number">153</span>
        Import and export
      </a>
    </li>
    <li class="nav-item">
      <a href="/154">
        <span class="aip-number">154</span>
        Resource freshness validation
      </a>
    </li>
    <li class="nav-item">
      <a href="/155">
        <span class="aip-number">155</span>
        Request identification
      </a>
    </li>
    <li class="nav-item">
      <a href="/156">
        <span class="aip-number">156</span>
        Singleton resources
      </a>
    </li>
    <li class="nav-item">
      <a href="/157">
        <span class="aip-number">157</span>
        Partial responses
      </a>
    </li>
    <li class="nav-item">
      <a href="/158">
        <span class="aip-number">158</span>
        Pagination
      </a>
    </li>
    <li class="nav-item">
      <a href="/159">
        <span class="aip-number">159</span>
        Reading across collections
      </a>
    </li>
    <li class="nav-item">
      <a href="/160">
        <span class="aip-number">160</span>
        Filtering
      </a>
    </li>
    <li class="nav-item">
      <a href="/161">
        <span class="aip-number">161</span>
        Field masks
      </a>
    </li>
    <li class="nav-item">
      <a href="/162">
        <span class="aip-number">162</span>
        Resource Revisions
      </a>
    </li>
    <li class="nav-item">
      <a href="/163">
        <span class="aip-number">163</span>
        Change validation
      </a>
    </li>
    <li class="nav-item">
      <a href="/164">
        <span class="aip-number">164</span>
        Soft delete
      </a>
    </li>
    <li class="nav-item">
      <a href="/165">
        <span class="aip-number">165</span>
        Criteria-based delete
      </a>
    </li>
    <li class="nav-item">
      <a href="/180">
        <span class="aip-number">180</span>
        Backwards compatibility
      </a>
    </li>
    <li class="nav-item">
      <a href="/181">
        <span class="aip-number">181</span>
        Stability levels
      </a>
    </li>
    <li class="nav-item">
      <a href="/182">
        <span class="aip-number">182</span>
        External software dependencies
      </a>
    </li>
    <li class="nav-item">
      <a href="/185">
        <span class="aip-number">185</span>
        API Versioning
      </a>
    </li>
    <li class="nav-item">
      <a href="/190">
        <span class="aip-number">190</span>
        Naming conventions
      </a>
    </li>
    <li class="nav-item">
      <a href="/191">
        <span class="aip-number">191</span>
        File and directory structure
      </a>
    </li>
    <li class="nav-item">
      <a href="/192">
        <span class="aip-number">192</span>
        Documentation
      </a>
    </li>
    <li class="nav-item">
      <a href="/193">
        <span class="aip-number">193</span>
        Errors
      </a>
    </li>
    <li class="nav-item">
      <a href="/194">
        <span class="aip-number">194</span>
        Automatic retry configuration
      </a>
    </li>
    <li class="nav-item">
      <a href="/200">
        <span class="aip-number">200</span>
        Precedent
      </a>
    </li>
    <li class="nav-item">
      <a href="/202">
        <span class="aip-number">202</span>
        Fields
      </a>
    </li>
    <li class="nav-item">
      <a href="/203">
        <span class="aip-number">203</span>
        Field behavior documentation
      </a>
    </li>
    <li class="nav-item">
      <a href="/205">
        <span class="aip-number">205</span>
        Beta-blocking changes
      </a>
    </li>
    <li class="nav-item">
      <a href="/210">
        <span class="aip-number">210</span>
        Unicode
      </a>
    </li>
    <li class="nav-item">
      <a href="/211">
        <span class="aip-number">211</span>
        Authorization checks
      </a>
    </li>
    <li class="nav-item">
      <a href="/213">
        <span class="aip-number">213</span>
        Common components
      </a>
    </li>
    <li class="nav-item">
      <a href="/214">
        <span class="aip-number">214</span>
        Resource expiration
      </a>
    </li>
    <li class="nav-item">
      <a href="/215">
        <span class="aip-number">215</span>
        API-specific protos
      </a>
    </li>
    <li class="nav-item">
      <a href="/216">
        <span class="aip-number">216</span>
        States
      </a>
    </li>
    <li class="nav-item">
      <a href="/217">
        <span class="aip-number">217</span>
        Unreachable resources
      </a>
    </li>
    <li class="nav-item">
      <a href="/231">
        <span class="aip-number">231</span>
        Batch methods: Get
      </a>
    </li>
    <li class="nav-item">
      <a href="/233">
        <span class="aip-number">233</span>
        Batch methods: Create
      </a>
    </li>
    <li class="nav-item">
      <a href="/234">
        <span class="aip-number">234</span>
        Batch methods: Update
      </a>
    </li>
    <li class="nav-item">
      <a href="/235">
        <span class="aip-number">235</span>
        Batch methods: Delete
      </a>
    </li>
    <li class="nav-item">
      <a href="/236">
        <span class="aip-number">236</span>
        Policy preview
      </a>
    </li>
    </ul>
</nav>
<section id="jump-content">
          
<aside id="aip-sidebar" class="docs-component-sidebar">
  <table id="aip-summary">
    <tr><th colspan="2">Custom methods</th></tr>
    <tr><td>Number</td><td>136</td></tr>
    <tr><td>Permalink</td><td><a href="https://google.aip.dev/136">google.aip.dev/136</a></td></tr>
    <tr><td>State</td><td>Approved</td></tr>
    <tr><td>Created</td><td>2019-01-25</td></tr>
    <tr><td>Updated</td><td>2019-01-25</td></tr>
  </table>

  <section id="aip-toc" class="docs-component-sidebar-toc">
    <div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#guidance">Guidance</a><ul>
<li><a href="#resource-based-custom-methods">Resource-based custom methods</a></li>
<li><a href="#collection-based-custom-methods">Collection-based custom methods</a></li>
<li><a href="#stateless-methods">Stateless methods</a></li>
<li><a href="#declarative-friendly-resources">Declarative-friendly resources</a></li>
</ul>
</li>
<li><a href="#rationale">Rationale</a><ul>
<li><a href="#http-path">HTTP path</a></li>
<li><a href="#http-methods">HTTP methods</a></li>
<li><a href="#disallowing-prepositions">Disallowing prepositions</a></li>
<li><a href="#rpc-name">RPC name</a></li>
</ul>
</li>
<li><a href="#changelog">Changelog</a></li>
</ul>
</div>

  </section>

  <section class="docs-component-sidebar-actions">
    <ul>
      <li><a href="https://github.com/aip-dev/google.aip.dev/issues/">File Bug</a></li>
      <li><a href="https://github.com/aip-dev/google.aip.dev/blob/master/aip/general/0136.md">View source</a></li>
      <li><a href="https://github.com/aip-dev/google.aip.dev/edit/master/aip/general/0136.md">Edit this page</a></li>
    </ul>
  </section>
</aside>
<section id="aip-main" class="docs-component-main">
  <section class="section-breadcrumbs">
  <nav
    class="glue-breadcrumbs glue-mod-mt-std glue-mod-mb-std"
    aria-label="You are here."
  >
    <ol class="glue-breadcrumbs__list aip-breadcrumbs">
      <li class="glue-breadcrumbs__item" aria-level="1">
        <a class="glue-breadcrumbs__link" href="/">
          API Improvement Proposals
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item" aria-level="2">
        <a class="glue-breadcrumbs__link" href="/general">
          General AIPs
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item glue-breadcrumbs__item--active"
          aria-level="3">
        Custom methods
      </li>
    </ol>
  </nav>
</section>
  
  <h4 class="aip-number">AIP-136</h4>
  <h1 id="custom-methods">Custom methods</h1>
<p>Resource-oriented design (<a href="/121">AIP-121</a>) uses custom methods to provide a means to
express arbitrary actions that are difficult to model using only the standard
methods. Custom methods are important because they provide a means for an API's
vocabulary to adhere to user intent.</p>
<h2 id="guidance">Guidance</h2>
<p>Custom methods <strong>should</strong> only be used for functionality that can not be easily
expressed via standard methods; prefer standard methods if possible, due to
their consistent semantics. (Of course, this only applies if the functionality
in question actually conforms to the normal semantics; it is <em>not</em> a good idea
to contort things to endeavor to make the standard methods "sort of work".)</p>
<p>While custom methods vary widely in how they are designed, many principles
apply consistently:</p>
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// Archives the given book.</span>
<span class="k">rpc</span> <span class="n">ArchiveBook</span><span class="p">(</span><span class="n">ArchiveBookRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">ArchiveBookResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">post</span><span class="o">:</span> <span class="s">&quot;/v1/{name=publishers/*/books/*}:archive&quot;</span>
    <span class="n">body</span><span class="o">:</span> <span class="s">&quot;*&quot;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Note:</strong> The pattern above shows a custom method that operates on a specific
resource. Custom methods can be associated with resources, collections, or
services. The bullets below apply in all three cases.</p>
<ul>
<li>The name of the method <strong>should</strong> be a verb followed by a noun.<ul>
<li>The name <strong>must not</strong> contain prepositions ("for", "with", etc.).</li>
<li>The verb in the name <strong>should not</strong> contain any of the standard method verbs (<a href="/131">Get</a>,
  <a href="/132">List</a>, <a href="/133">Create</a>, <a href="/134">Update</a>, <a href="/135">Delete</a>).</li>
<li>The name <strong>must not</strong> include the term <code>Async</code>. Instead, if the intention is
  to differentiate between immediate and long-running RPCs, the suffix <code>LongRunning</code>
  <strong>may</strong> be used for this purpose. For example, to create a long-running book creation
  RPC (if the standard <code>CreateBook</code> method was designed before long-running aspects were
  considered), a custom <code>CreateBookLongRunning</code> method could be introduced.</li>
</ul>
</li>
<li>The HTTP method <strong>must</strong> be <code>GET</code> or <code>POST</code>:<ul>
<li><code>GET</code> <strong>must</strong> be used for methods retrieving data or resource state.</li>
<li><code>POST</code> <strong>must</strong> be used if the method has side effects or mutates resources
  or data.</li>
</ul>
</li>
<li>The HTTP URI <strong>must</strong> use a <code>:</code> character followed by the custom verb
  (<code>:archive</code> in the above example), and the verb in the URI <strong>must</strong> match the
  verb in the name of the RPC.<ul>
<li>If word separation is required, <code>camelCase</code> <strong>must</strong> be used.</li>
</ul>
</li>
<li>The <code>body</code> clause in the <code>google.api.http</code> annotation <strong>should</strong> be <code>"*"</code>.<ul>
<li>See <a href="/127">HTTP and gRPC Transcoding</a> for more information.</li>
</ul>
</li>
<li>Custom methods <strong>should</strong> take a request message matching the RPC
  name, with a <code>Request</code> suffix.</li>
<li>Custom methods <strong>should</strong> return a response message matching the RPC
  name, with a <code>Response</code> suffix.<ul>
<li>When operating on a specific resource, a custom method <strong>may</strong> return the
  resource itself.</li>
</ul>
</li>
</ul>
<h3 id="resource-based-custom-methods">Resource-based custom methods</h3>
<p>Custom methods <strong>must</strong> operate on a resource if the API can be modeled
as such:</p>
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// Archives the given book.</span>
<span class="k">rpc</span> <span class="n">ArchiveBook</span><span class="p">(</span><span class="n">ArchiveBookRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">ArchiveBookResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">post</span><span class="o">:</span> <span class="s">&quot;/v1/{name=publishers/*/books/*}:archive&quot;</span>
    <span class="n">body</span><span class="o">:</span> <span class="s">&quot;*&quot;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>The parameter for the resource's name <strong>must</strong> be called <code>name</code>, and
  be the only variable in the URI path.</li>
</ul>
<h3 id="collection-based-custom-methods">Collection-based custom methods</h3>
<p>While most custom methods operate on a single resource, some custom methods
<strong>may</strong> operate on a collection instead:</p>
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// Sorts the books from this publisher.</span>
<span class="k">rpc</span> <span class="n">SortBooks</span><span class="p">(</span><span class="n">SortBooksRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">SortBooksResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">post</span><span class="o">:</span> <span class="s">&quot;/v1/{parent=publishers/*}/books:sort&quot;</span>
    <span class="n">body</span><span class="o">:</span> <span class="s">&quot;*&quot;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>The collection's parent resource <strong>must</strong> be called <code>parent</code>, and
  be the only variable in the URI path.</li>
<li>The collection key (<code>books</code> in the above example) <strong>must</strong> be literal.</li>
</ul>
<h3 id="stateless-methods">Stateless methods</h3>
<p>Some custom methods are not attached to resources at all. These methods are
generally <em>stateless</em>: they accept a request and return a response, and have no
permanent effect on data within the API.</p>
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// Translates the provided text from one language to another.</span>
<span class="k">rpc</span> <span class="n">TranslateText</span><span class="p">(</span><span class="n">TranslateTextRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">TranslateTextResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">post</span><span class="o">:</span> <span class="s">&quot;/v1/{project=projects/*}:translateText&quot;</span>
    <span class="n">body</span><span class="o">:</span> <span class="s">&quot;*&quot;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>If the method runs in a particular scope (such as a project, as in the above
  example), the field name in the request message <strong>should</strong> be the name of the
  scope resource. If word separators are necessary, <code>snake_case</code> <strong>must</strong> be
  used.</li>
<li>The URI <strong>should</strong> place both the verb and noun after the <code>:</code> separator
  (avoid a "faux collection key" in the URI in this case, as there is no
  collection). For example, <code>:translateText</code> is preferable to <code>text:translate</code>.</li>
<li>Stateless methods <strong>must</strong> use <code>POST</code> if they involve billing.</li>
</ul>
<h3 id="declarative-friendly-resources">Declarative-friendly resources</h3>
<p>Declarative-friendly resources usually <strong>should not</strong> employ custom methods
(except specific declarative-friendly custom methods discussed in other AIPs),
because declarative-friendly tools are unable to automatically determine what
to do with them.</p>
<p>An exception to this is for rarely-used, fundamentally imperative operations,
such as a <code>Move</code> or <code>Rename</code> operation, for which there would not be an
expectation of declarative support.</p>
<h2 id="rationale">Rationale</h2>
<h3 id="http-path">HTTP path</h3>
<p>Similar to standard methods, a custom method that operates on a resource or
collection needs a <code>name</code> or <code>parent</code> parameter to indicate the resource that it
operates on. This convention allows clients to map custom methods to the
appropriate resource.</p>
<h3 id="http-methods">HTTP methods</h3>
<p>Allowing both <code>GET</code> and <code>POST</code> HTTP verbs allows a clear distinction for
which methods do not mutate data, and which ones do. Methods that only
read data have first-class concepts in some clients (DataSources in
Terraform) and clearly indicate to a user which methods can be called
without risk of runtime impact.</p>
<h3 id="disallowing-prepositions">Disallowing prepositions</h3>
<p>Generally, method names with prepositions indicate that a new method is being
used where a field should instead be added to an existing method, or the method
should use a distinct verb. For example, if a <code>CreateBook</code> message already
exists and you are considering adding <code>CreateBookFromDictation</code>, consider a
<code>TranscribeBook</code> method instead. Similarly, if there is desire for a
property-specific look-up method, instead of <code>GetBookByAuthor</code> consider a
<code>SearchBooks</code> with an <code>author</code> field as a search dimension. This helps prevent
an explosion of hyper-focused methods that bloat API and client surfaces, and
add complexity to both managing and consuming the API.</p>
<h3 id="rpc-name">RPC name</h3>
<p>The term "async" is commonly used in programming languages to indicate whether
a specific method call is synchronous or asynchronous, including for making RPCs.
That sync/async aspect is at a different abstraction level to whether the RPC
itself is intended to start a long-running operation. Using "async" within the
RPC name itself causes confusion, and can even cause issues for client libraries
which generate both synchronous and asynchronous methods to call the RPC in some
languages.</p>
<h2 id="changelog">Changelog</h2>
<ul>
<li><strong>2025-05-12:</strong> Extend disallowing prepositions rationale.</li>
<li><strong>2025-01-09:</strong> Add original rationale for disallowing prepositions in names.</li>
<li><strong>2023-11-16:</strong> Included link to <a href="/127">AIP-127</a> "HTTP and gRPC Transcoding" for guidance on body definition.</li>
<li><strong>2023-05-16:</strong> Added prohibition of the term "async" within RPC names.</li>
<li><strong>2023-05-09:</strong> Adding guidance for POST and GET, require parent instead of
  the resource singular.</li>
<li><strong>2023-03-02:</strong> Explicitly discourage use of standard method verbs.</li>
<li><strong>2022-06-02:</strong> Changed suffix descriptions to eliminate superfluous "-".</li>
<li><strong>2020-10-06:</strong> Added declarative-friendly guidance.</li>
<li><strong>2019-08-01:</strong> Changed the examples from "shelves" to "publishers", to
  present a better example of resource ownership.</li>
</ul>
  <footer>
  Except as otherwise noted, the content of this page is licensed under the
  <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
  Attribution 4.0 License</a>, and code samples are licensed under the
  <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
  <span class="no-print">For details, see <a href="/licensing">content
  licensing</a>.</span>
</footer>
</section>

        </section>
      </main>
      
    </div>
    <script src="//www.gstatic.com/external_hosted/hammerjs/v2_0_2/hammer.min.js"></script>
    <script src="//www.gstatic.com/glue/v22_1/glue-vanilla.min.js"></script>
    <script type="text/javascript">
      const headerElement = document.querySelector('.glue-header');
      if (headerElement) {
        new window.glue.ui.header.Header(headerElement);
      }
    </script>
  </body>
</html>